<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificato NIS2 - {{ supplier_name }}</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        body {
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
            color: #1a1a1a;
            background: white;
            font-size: 12px;
        }
        .header {
            text-align: center;
            border-bottom: 4px solid #059669;
            padding-bottom: 25px;
            margin-bottom: 30px;
            position: relative;
        }
        .header::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background: #dc2626;
        }
        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #059669;
            margin-bottom: 8px;
            letter-spacing: 2px;
        }
        .title {
            font-size: 32px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .subtitle {
            font-size: 14px;
            color: #6b7280;
            font-style: italic;
        }
        .certificate-body {
            margin: 40px 0;
        }
        .certificate-text {
            font-size: 14px;
            text-align: justify;
            margin-bottom: 25px;
            line-height: 1.8;
        }
        .supplier-info {
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
            border: 3px solid #059669;
            border-radius: 12px;
            padding: 30px;
            margin: 35px 0;
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.1);
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            font-size: 14px;
            align-items: center;
        }
        .info-label {
            font-weight: bold;
            color: #1f2937;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 0.5px;
        }
        .info-value {
            color: #059669;
            font-weight: 700;
            font-size: 16px;
        }
        .score-highlight {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin: 25px 0;
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }
        .compliance-section {
            background: #f8fafc;
            border-left: 5px solid #059669;
            padding: 25px;
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
        }
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .requirements-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .requirement-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 15px;
            font-size: 12px;
        }
        .requirement-title {
            font-weight: bold;
            color: #059669;
            margin-bottom: 8px;
            font-size: 13px;
        }
        .recommendations {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
        }
        .recommendation-item {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
            font-size: 12px;
        }
        .recommendation-item:before {
            content: "✓";
            color: #059669;
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        .footer {
            margin-top: 60px;
            text-align: center;
            font-size: 11px;
            color: #6b7280;
            border-top: 2px solid #e5e7eb;
            padding-top: 20px;
        }
        .signature-section {
            margin-top: 80px;
            display: flex;
            justify-content: space-between;
        }
        .signature-box {
            width: 45%;
            text-align: center;
        }
        .signature-line {
            border-top: 2px solid #1f2937;
            margin-top: 60px;
            padding-top: 15px;
            font-size: 12px;
        }
        .signature-stamp {
            width: 200px;
            height: 80px;
            border: 2px solid #059669;
            border-radius: 8px;
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
            margin: 20px auto;
            position: relative;
            overflow: hidden;
        }
        .signature-line {
            position: absolute;
            bottom: 25px;
            left: 20px;
            right: 20px;
            height: 3px;
            background: #059669;
            border-radius: 2px;
        }
        .signature-text {
            position: absolute;
            top: 15px;
            left: 20px;
            font-size: 12px;
            color: #059669;
            font-weight: 600;
        }
        .signature-name {
            position: absolute;
            bottom: 8px;
            left: 20px;
            font-size: 16px;
            color: #059669;
            font-weight: 700;
            font-family: 'Brush Script MT', cursive;
        }
        .qr-section {
            text-align: center;
            margin: 35px 0;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
        }
        .qr-placeholder {
            width: 120px;
            height: 120px;
            background: #f3f4f6;
            border: 2px dashed #d1d5db;
            display: inline-block;
            line-height: 120px;
            color: #9ca3af;
            font-size: 10px;
            border-radius: 8px;
        }
        .validity-badge {
            background: #059669;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            display: inline-block;
            margin: 10px 0;
        }
        .legal-notice {
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            font-size: 11px;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">NIS2 SUPPLY CHAIN</div>
        <div class="title">Certificato di Conformità</div>
        <div class="subtitle">Direttiva (UE) 2022/2555 - Network and Information Security</div>
    </div>

    <div class="certificate-body">
        <div class="certificate-text">
            Si certifica ufficialmente che il fornitore <strong>{{ supplier_name }}</strong> ha superato con successo 
            l'assessment di conformità NIS2 condotto da <strong>{{ company_name }}</strong> e risulta 
            pienamente conforme ai requisiti di sicurezza della supply chain secondo la Direttiva NIS2 (UE) 2022/2555.
        </div>

        <div class="supplier-info">
            <div class="info-row">
                <span class="info-label">Nome Fornitore:</span>
                <span class="info-value">{{ supplier_name }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Azienda Certificante:</span>
                <span class="info-value">{{ company_name }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Data Assessment:</span>
                <span class="info-value">{{ assessment_date }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Punteggio Conformità:</span>
                <span class="info-value">{{ compliance_score }}%</span>
            </div>
            <div class="info-row">
                <span class="info-label">Stato Certificazione:</span>
                <span class="validity-badge">✅ CONFORME NIS2</span>
            </div>
        </div>

        <div class="score-highlight">
            ✅ FORNITORE CONFORME - Punteggio: {{ compliance_score }}%
        </div>

        <div class="compliance-section">
            <div class="section-title">Requisiti NIS2 Implementati</div>
            <div class="requirements-grid">
                <div class="requirement-item">
                    <div class="requirement-title">Gestione del Rischio</div>
                    <div>Politiche di gestione del rischio informatico implementate e documentate</div>
                </div>
                <div class="requirement-item">
                    <div class="requirement-title">Sicurezza delle Reti</div>
                    <div>Controlli di sicurezza delle reti e sistemi informativi operativi</div>
                </div>
                <div class="requirement-item">
                    <div class="requirement-title">Gestione Incidenti</div>
                    <div>Procedure di gestione degli incidenti di sicurezza implementate</div>
                </div>
                <div class="requirement-item">
                    <div class="requirement-title">Business Continuity</div>
                    <div>Piani di continuità operativa e disaster recovery attivi</div>
                </div>
                <div class="requirement-item">
                    <div class="requirement-title">Supply Chain Security</div>
                    <div>Controlli di sicurezza della supply chain implementati</div>
                </div>
                <div class="requirement-item">
                    <div class="requirement-title">Formazione del Personale</div>
                    <div>Programmi di formazione sulla sicurezza informatica attivi</div>
                </div>
            </div>
        </div>

        <div class="recommendations">
            <div class="section-title">Raccomandazioni per il Mantenimento</div>
            <div class="recommendation-item">Mantenere aggiornate le politiche di sicurezza almeno ogni 12 mesi</div>
            <div class="recommendation-item">Condurre audit di sicurezza interni trimestrali</div>
            <div class="recommendation-item">Aggiornare regolarmente i piani di disaster recovery</div>
            <div class="recommendation-item">Monitorare continuamente le minacce emergenti</div>
            <div class="recommendation-item">Formare il personale su nuove minacce e procedure</div>
            <div class="recommendation-item">Testare i piani di continuità operativa semestralmente</div>
        </div>

        <div class="certificate-text">
            Questo certificato attesta che il fornitore ha implementato adeguate misure di sicurezza 
            informatica e rispetta i requisiti della Direttiva NIS2. Il certificato è valido per 
            <strong>12 mesi</strong> dalla data di emissione, salvo modifiche normative che richiedano 
            aggiornamenti anticipati.
        </div>

        <div class="qr-section">
            {% if qr_code %}
                <img src="{{ qr_code }}" alt="QR Code" style="width: 120px; height: 120px; border: 2px solid #d1d5db; border-radius: 8px;">
            {% else %}
                <div class="qr-placeholder">QR CODE</div>
            {% endif %}
            <p style="font-size: 11px; color: #6b7280; margin-top: 10px;">
                Scansiona per verificare l'autenticità del certificato
            </p>
        </div>

        <div class="legal-notice">
            <strong>Nota Legale:</strong> Questo certificato è generato automaticamente dal sistema NIS2 Supply Chain Platform. 
            La conformità è verificata secondo i requisiti della Direttiva NIS2 (UE) 2022/2555. 
            Per verifiche ufficiali, contattare l'azienda certificante.
        </div>
    </div>

    <div class="signature-section">
        <div class="signature-box">
            <div class="signature-stamp">
                <div class="signature-text">Firma Digitale</div>
                <div class="signature-line"></div>
                <div class="signature-name">Dr. Marco Rossi</div>
            </div>
            <div class="signature-line">
                Responsabile Sicurezza Informatica<br>
                {{ company_name }}<br>
                <small>Firma e timbro</small>
            </div>
        </div>
        <div class="signature-box">
            <div class="signature-line">
                Data Emissione<br>
                {{ assessment_date }}<br>
                <small>Certificato valido fino al</small><br>
                <small>{{ assessment_date }}</small>
            </div>
        </div>
    </div>

    <div class="footer">
        <p><strong>NIS2 SUPPLY CHAIN PLATFORM</strong> - Sistema di Certificazione Conformità</p>
        <p>ID Certificato: CERT-{{ supplier_id }}-{{ assessment_date.replace('-', '') if assessment_date else 'NODATE' }}</p>
        <p>Questo documento è generato automaticamente e contiene informazioni protette dalla Direttiva NIS2</p>
    </div>
</body>
</html>
